# Physiotherapy Scheduler PWA

A Progressive Web Application for physiotherapy appointment scheduling at King Abdullah Hospital - Bisha.

## Features

- **Offline-First**: Works completely offline after initial load
- **Bilingual Support**: Full Arabic/English localization with RTL/LTR support
- **IndexedDB Storage**: Reliable data persistence with automatic sync when online
- **PWA Installation**: Can be installed as a native app on mobile and desktop
- **Print Support**: Professional A4 printing for exercise programs
- **Real-time Updates**: Automatic app updates with user notification

## Quick Deploy to Netlify

### Prerequisites
- Node.js 18+ 
- npm or yarn package manager

### Deployment Steps

1. **Clone and Install**
   ```bash
   git clone <repository-url>
   cd tenten
   npm install
   ```

2. **Build for Production**
   ```bash
   npm run build
   ```

3. **Deploy to Netlify**

   **Option A: Netlify CLI**
   ```bash
   npm install -g netlify-cli
   netlify login
   netlify deploy --prod --dir=dist
   ```

   **Option B: Drag & Drop**
   - Go to [Netlify Drop](https://app.netlify.com/drop)
   - Drag the `dist` folder to the deployment area

   **Option C: Git Integration**
   - Connect your Git repository to Netlify
   - Set build command: `npm run build`
   - Set publish directory: `dist`

4. **Verify PWA Installation**
   - Visit your deployed site
   - Check for "Install App" option in browser
   - Test offline functionality by disconnecting internet
   - Verify all images and assets load properly

## Development

### Local Development
```bash
npm run dev
```
The app will be available at `http://localhost:5173` with PWA features enabled.

### Production Preview
```bash
npm run build
npm run preview
```

## PWA Features

### Service Worker
- Automatically generated by Workbox
- Precaches all critical assets (JS, CSS, HTML)
- Runtime caching for images and fonts
- Offline fallback to index.html for all routes

### Data Storage
- **Primary Storage**: IndexedDB for appointments, providers, schedules
- **Settings Storage**: localStorage for language preferences and light settings
- **Offline Sync**: Queues changes when offline, syncs when reconnected

### Installation
The app can be installed on:
- **Android**: Chrome "Add to Home Screen" 
- **iOS**: Safari "Add to Home Screen"
- **Desktop**: Chrome/Edge "Install App" option
- **Windows**: Creates Start Menu shortcut
- **macOS**: Creates Applications folder shortcut

### Offline Capabilities
- ✅ View existing appointments and schedules
- ✅ Create new appointments (synced when online)
- ✅ Access exercise programs and print
- ✅ Change app settings and language
- ✅ Browse provider schedules and availability

## Architecture

### Data Flow
```
User Interface
    ↓
React Context (AppContext)
    ↓
IndexedDB Hooks (useIndexedDB)
    ↓
IndexedDB Storage + Sync Queue
    ↓
Service Worker (offline caching)
```

### File Structure
```
src/
├── components/          # React components
│   ├── common/         # Shared components
│   ├── modals/         # Modal dialogs
│   └── views/          # Calendar views
├── context/            # React Context providers
├── hooks/              # Custom hooks (localStorage, IndexedDB)
├── i18n/              # Internationalization
├── types.ts           # TypeScript definitions
├── utils/             # Utility functions
│   ├── dateUtils.ts   # Date handling
│   ├── indexedDB.ts   # Database operations
│   └── helpers.ts     # General utilities
└── Public/            # Static assets
    └── exercsies/     # Exercise images
```

## Configuration Files

### `netlify.toml`
- Build configuration
- SPA routing redirects
- Security headers
- Caching policies

### `vite.config.ts`
- PWA plugin configuration
- Service worker settings
- Asset optimization
- Build settings

### `manifest.webmanifest` (Auto-generated)
- App metadata for installation
- Icon definitions
- Display preferences
- Theme colors

## Browser Support

### PWA Features
- ✅ Chrome 67+ (Android, Desktop)
- ✅ Firefox 79+ (Android, Desktop)
- ✅ Safari 14+ (iOS, macOS)
- ✅ Edge 79+ (Windows, Android)

### Core Functionality
- ✅ All modern browsers with ES2015+ support
- ✅ Mobile browsers (iOS Safari, Android Chrome)
- ✅ Desktop browsers (Chrome, Firefox, Safari, Edge)

## Troubleshooting

### Common Issues

**PWA Not Installing**
- Check that site is served over HTTPS
- Verify manifest.webmanifest is accessible
- Ensure service worker is registered successfully

**Offline Mode Not Working**
- Clear browser cache and reload
- Check browser DevTools > Application > Service Workers
- Verify IndexedDB contains data

**Images Not Loading Offline**
- Check that images are in Public/ directory
- Verify Vite PWA plugin includes image patterns
- Check service worker cache in DevTools

**Build Failures**
- Clear node_modules and reinstall: `rm -rf node_modules package-lock.json && npm install`
- Check Node.js version (requires 18+)
- Verify all dependencies are installed

### Debug Mode
Enable PWA development mode in `vite.config.ts`:
```javascript
VitePWA({
  devOptions: {
    enabled: true
  }
})
```

## Security

### Headers Configuration
- Content Security Policy (CSP)
- X-Frame-Options: DENY
- X-Content-Type-Options: nosniff
- Strict Transport Security (HSTS)
- Referrer Policy restrictions

### Data Privacy
- All data stored locally (IndexedDB/localStorage)
- No external API calls or tracking
- GDPR compliant (local-first architecture)

## Performance

### Lighthouse Scores (Target)
- ✅ Performance: 90+
- ✅ Accessibility: 95+
- ✅ Best Practices: 95+
- ✅ SEO: 90+
- ✅ PWA: 100

### Optimization
- Code splitting with dynamic imports
- Image optimization and lazy loading
- Service worker caching strategies
- Minimal bundle size with tree shaking

## Support

For deployment issues or questions:
1. Check browser DevTools console for errors
2. Verify network connectivity
3. Test in incognito/private browsing mode
4. Check Netlify deploy logs for build issues

## License

This project is for healthcare use at King Abdullah Hospital - Bisha.